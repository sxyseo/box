!function(t){function e(t,e,n,a){if(!t.tag.isInline&&n.length>0)for(n.push("\n"),i=0;a>i;i++)n.push("	")}function n(a,i){var r,s=[],l=0==a.attributes.length;if(a.tag.isComment)i.allowComments&&(s.push("<!--"),s.push(a.tag.rawAttributes),s.push(">"),i.format&&e(a,i,s,r-1));else{var h=(this.name.concat(void 0==a.tag.rawAttributes?"":a.tag.rawAttributes),a.tag.render&&(0==i.allowedTags.length||t.inArray(a.tag.name,i.allowedTags)>-1)&&(0==i.removeTags.length||-1==t.inArray(a.tag.name,i.removeTags)));if(!a.isRoot&&h&&(s.push("<"),s.push(a.tag.name),t.each(a.attributes,function(){if(-1==t.inArray(this.name,i.removeAttrs)){var e=RegExp(/^(['"]?)(.*?)['"]?$/).exec(this.value),n=e[2],r=e[1]||"'";"class"==this.name&&i.allowedClasses.length>0&&(n=t.grep(n.split(" "),function(e){return t.grep(i.allowedClasses,function(n){return n==e||n[0]==e&&(1==n.length||t.inArray(a.tag.name,n[1])>-1)}).length>0}).join(" ")),null!=n&&(n.length>0||t.inArray(this.name,a.tag.requiredAttributes)>-1)&&(s.push(" "),s.push(this.name),s.push("="),s.push(r),s.push(n),s.push(r))}})),a.tag.isSelfClosing)h&&s.push(" />"),l=!1;else if(a.tag.isNonClosing)l=!1;else{!a.isRoot&&h&&s.push(">");var r=i.formatIndent++;if(a.tag.toProtect){var o=t.htmlClean.trim(a.children.join("")).replace(/<br>/gi,"\n");s.push(o),l=0==o.length}else{for(var o=[],d=0;d<a.children.length;d++){var f=a.children[d],b=t.htmlClean.trim(p(m(f)?f:f.childrenToString()));g(f)&&d>0&&b.length>0&&(c(f)||u(a.children[d-1]))&&o.push(" "),m(f)?b.length>0&&o.push(b):(d!=a.children.length-1||"br"!=f.tag.name)&&(i.format&&e(f,i,o,r),o=o.concat(n(f,i)))}i.formatIndent--,o.length>0&&(i.format&&"\n"!=o[0]&&e(a,i,s,r),s=s.concat(o),l=!1)}!a.isRoot&&h&&(i.format&&e(a,i,s,r-1),s.push("</"),s.push(a.tag.name),s.push(">"))}if(!a.tag.allowEmpty&&l)return[]}return s}function a(e,n){return s(e,function(e){return t.inArray(e.tag.nameOriginal,n)>-1})}function r(t){return s(t,function(t){return t.isRoot||!t.tag.isInline})}function s(t,e,n){n=n||1;var a=t[t.length-n];return e(a)?!0:t.length-n>0&&s(t,e,n+1)?(t.pop(),!0):!1}function l(t){return t?(this.tag=t,this.isRoot=!1):(this.tag=new o("root"),this.isRoot=!0),this.attributes=[],this.children=[],this.hasAttribute=function(t){for(var e=0;e<this.attributes.length;e++)if(this.attributes[e].name==t)return!0;return!1},this.childrenToString=function(){return this.children.join("")},this}function h(t,e){return this.name=t,this.value=e,this}function o(e,n,a,i){return this.name=e.toLowerCase(),this.nameOriginal=this.name,this.render=!0,this.init=function(){if("--"==this.name?(this.isComment=!0,this.isSelfClosing=!0):(this.isComment=!1,this.isSelfClosing=t.inArray(this.name,v)>-1,this.isNonClosing=t.inArray(this.name,w)>-1,this.isClosing=void 0!=n&&n.length>0,this.isInline=t.inArray(this.name,f)>-1,this.disallowNest=t.inArray(this.name,b)>-1,this.requiredParent=A[t.inArray(this.name,A)+1],this.allowEmpty=t.inArray(this.name,y)>-1,this.toProtect=t.inArray(this.name,C)>-1),this.rawAttributes=a,this.requiredAttributes=S[t.inArray(this.name,S)+1],i){if(i.tagAttributesCache||(i.tagAttributesCache=[]),-1==t.inArray(this.name,i.tagAttributesCache)){for(var e=x[t.inArray(this.name,x)+1].slice(0),r=0;r<i.allowedAttributes.length;r++){var s=i.allowedAttributes[r][0];(1==i.allowedAttributes[r].length||t.inArray(this.name,i.allowedAttributes[r][1])>-1)&&-1==t.inArray(s,e)&&e.push(s)}i.tagAttributesCache.push(this.name),i.tagAttributesCache.push(e)}this.allowedAttributes=i.tagAttributesCache[t.inArray(this.name,i.tagAttributesCache)+1]}},this.init(),this.rename=function(t){this.name=t,this.init()},this}function c(e){for(;d(e)&&e.children.length>0;)e=e.children[0];if(!m(e))return!1;var n=p(e);return n.length>0&&t.htmlClean.isWhitespace(n.charAt(0))}function u(e){for(;d(e)&&e.children.length>0;)e=e.children[e.children.length-1];if(!m(e))return!1;var n=p(e);return n.length>0&&t.htmlClean.isWhitespace(n.charAt(n.length-1))}function m(t){return t.constructor==String}function g(t){return m(t)||t.tag.isInline}function d(t){return t.constructor==l}function p(t){return t.replace(/&nbsp;|\n/g," ").replace(/\s\s+/g," ")}t.fn.htmlClean=function(e){return this.each(function(){t(this);this.value?this.value=t.htmlClean(this.value,e):this.innerHTML=t.htmlClean(this.innerHTML,e)})},t.htmlClean=function(e,i){i=t.extend({},t.htmlClean.defaults,i);var s,c=/(<(\/)?(\w+:)?([\w]+)([^>]*)>)|<!--(.*?--)>/gi,u=/([\w\-]+)=(".*?"|'.*?'|[^\s>]*)/gi,g=new l,d=[g],p=g;i.bodyOnly&&(s=/<body[^>]*>((\n|.)*)<\/body>/i.exec(e))&&(e=s[1]),e=e.concat("<xxx>");for(var f;s=c.exec(e);){var b=s[6]?new o("--",null,s[6],i):new o(s[4],s[2],s[5],i),y=e.substring(f,s.index);if(y.length>0){var A=p.children[p.children.length-1];p.children.length>0&&m(A=p.children[p.children.length-1])?p.children[p.children.length-1]=A.concat(y):p.children.push(y)}if(f=c.lastIndex,b.isClosing)a(d,[b.name])&&(d.pop(),p=d[d.length-1]);else{for(var C,v=new l(b);C=u.exec(b.rawAttributes);){if("style"==C[1].toLowerCase()&&i.replaceStyles)for(var w=!b.isInline,x=0;x<i.replaceStyles.length;x++)i.replaceStyles[x][0].test(C[2])&&(w||(b.render=!1,w=!0),p.children.push(v),d.push(v),p=v,b=new o(i.replaceStyles[x][1],"","",i),v=new l(b));null!=b.allowedAttributes&&(0==b.allowedAttributes.length||t.inArray(C[1],b.allowedAttributes)>-1)&&v.attributes.push(new h(C[1],C[2]))}t.each(b.requiredAttributes,function(){var t=this.toString();v.hasAttribute(t)||v.attributes.push(new h(t,""))});for(var S=0;S<i.replace.length;S++)for(var I=0;I<i.replace[S][0].length;I++){var k="string"==typeof i.replace[S][0][I];if(k&&i.replace[S][0][I]==b.name||!k&&i.replace[S][0][I].test(s)){b.rename(i.replace[S][1]),S=i.replace.length;break}}var q=!0;if(p.isRoot||(p.tag.isInline&&!b.isInline?(q=r(d))&&(p=d[d.length-1]):p.tag.disallowNest&&b.disallowNest&&!b.requiredParent?q=!1:b.requiredParent&&(q=a(d,b.requiredParent))&&(p=d[d.length-1])),q)if(p.children.push(v),b.toProtect)for(;tagMatch2=c.exec(e);){var T=new o(tagMatch2[3],tagMatch2[1],tagMatch2[4],i);if(T.isClosing&&T.name==b.name){v.children.push(RegExp.leftContext.substring(f)),f=c.lastIndex;break}}else b.isSelfClosing||b.isNonClosing||(d.push(v),p=v)}}return t.htmlClean.trim(n(g,i).join(""))},t.htmlClean.defaults={bodyOnly:!0,allowedTags:[],removeTags:["basefont","center","dir","font","frame","frameset","iframe","isindex","menu","noframes","s","strike","u"],allowedAttributes:[],removeAttrs:[],allowedClasses:[],format:!1,formatIndent:0,replace:[[["b","big"],"strong"],[["i"],"em"]],replaceStyles:[[/font-weight:\s*bold/i,"strong"],[/font-style:\s*italic/i,"em"],[/vertical-align:\s*super/i,"sup"],[/vertical-align:\s*sub/i,"sub"]],allowComments:!1},t.htmlClean.trim=function(e){return t.htmlClean.trimStart(t.htmlClean.trimEnd(e))},t.htmlClean.trimStart=function(e){return e.substring(t.htmlClean.trimStartIndex(e))},t.htmlClean.trimStartIndex=function(e){for(var n=0;n<e.length-1&&t.htmlClean.isWhitespace(e.charAt(n));n++);return n},t.htmlClean.trimEnd=function(e){return e.substring(0,t.htmlClean.trimEndIndex(e))},t.htmlClean.trimEndIndex=function(e){for(var n=e.length-1;n>=0&&t.htmlClean.isWhitespace(e.charAt(n));n--);return n+1},t.htmlClean.isWhitespace=function(e){return-1!=t.inArray(e,I)};var f=["a","abbr","acronym","address","b","big","br","button","caption","cite","code","del","em","font","hr","i","input","img","ins","label","legend","map","q","s","samp","select","option","param","small","span","strike","strong","sub","sup","tt","u","var"],b=["h1","h2","h3","h4","h5","h6","p","th","td","object"],y=["th","td"],A=[null,"li",["ul","ol"],"dt",["dl"],"dd",["dl"],"td",["tr"],"th",["tr"],"tr",["table","thead","tbody","tfoot"],"thead",["table"],"tbody",["table"],"tfoot",["table"],"param",["object"]],C=["script","style","pre","code"],v=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],w=["!doctype","?xml"],x=[["class"],"?xml",[],"!doctype",[],"a",["accesskey","class","href","name","title","rel","rev","type","tabindex"],"abbr",["class","title"],"acronym",["class","title"],"blockquote",["cite","class"],"button",["class","disabled","name","type","value"],"del",["cite","class","datetime"],"form",["accept","action","class","enctype","method","name"],"input",["accept","accesskey","alt","checked","class","disabled","ismap","maxlength","name","size","readonly","src","tabindex","type","usemap","value"],"img",["alt","class","height","src","width"],"ins",["cite","class","datetime"],"label",["accesskey","class","for"],"legend",["accesskey","class"],"link",["href","rel","type"],"meta",["content","http-equiv","name","scheme","charset"],"map",["name"],"optgroup",["class","disabled","label"],"option",["class","disabled","label","selected","value"],"q",["class","cite"],"script",["src","type"],"select",["class","disabled","multiple","name","size","tabindex"],"style",["type"],"table",["class","summary"],"th",["class","colspan","rowspan"],"td",["class","colspan","rowspan"],"textarea",["accesskey","class","cols","disabled","name","readonly","rows","tabindex"],"param",["name","value"],"embed",["height","src","type","width"]],S=[[],"img",["alt"]],I=["Â "," ","	","\n","\r","\f"]}(jQuery);